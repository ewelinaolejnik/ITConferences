@model ITConferences.Domain.Entities.Conference
@using Microsoft.AspNet.Identity

<link rel="stylesheet" href="~/Content/bootstrap.css" />
<link rel="stylesheet" href="~/Content/star-rating.min.css" />


<script src="~/Scripts/jquery-2.2.0.min.js"></script>
<script src="~/Scripts/star-rating.min.js"></script>

<style>
    #full {
        width: 100%;
        height: 100%;
    }

    .btn-twitter {
        background: #00acee;
        border-radius: 0;
        color: #fff;
    }

        .btn-twitter:link, .btn-twitter:visited {
            color: #fff;
        }

        .btn-twitter:active, .btn-twitter:hover {
            background: #0087bd;
            color: #fff;
        }

    .btn-facebook {
        background: #3b5998;
        border-radius: 0;
        color: #fff;
    }

        .btn-facebook:link, .btn-facebook:visited {
            color: #fff;
        }

        .btn-facebook:active, .btn-facebook:hover {
            background: #30477a;
            color: #fff;
        }

    .btn-googleplus {
        background: #e93f2e;
        border-radius: 0;
        color: #fff;
    }

        .btn-googleplus:link, .btn-googleplus:visited {
            color: #fff;
        }

        .btn-googleplus:active, .btn-googleplus:hover {
            background: #ba3225;
            color: #fff;
        }

    .btn-linkedin {
        background: #0e76a8;
        border-radius: 0;
        color: #fff;
    }

        .btn-linkedin:link, .btn-linkedin:visited {
            color: #fff;
        }

        .btn-linkedin:active, .btn-linkedin:hover {
            background: #0b6087;
            color: #fff;
        }


    .buffer {
        margin-top: 20px;
        margin-bottom: 30px;
        margin-right: 20px;
    }
</style>



<div class="container" id="details">

    <div class="row buffer">
        <div class="col-md-4 col-xs-4">
            @Html.ActionLink("Back to the conferences", "Index")
        </div>
    </div>
    <div class="row text-success">
        <h1>
            @Html.DisplayFor(model => model.Name)
        </h1>
    </div>

    <div class="row">
        <div class="col-md-4 col-xs-4">
            @if (Model.Image != null)
            {
                <img src="@Url.Action("GetImage","Conferences", new {imageId = Model.ImageId}, null)" class="img-responsive img-thumbnail" alt="Conference image" />
            }
            else
            {
                <img src="../../img/default.jpg" class="img-responsive img-thumbnail" alt="Conference image" />
            }
        </div>

        <div class="col-md-8 col-xs-8">
            <dl class="dl-horizontal">
                <dt>
                    @Html.DisplayNameFor(model => model.TargetCity.Name)
                </dt>

                <dd>
                    @Html.DisplayFor(model => model.TargetCity.Name)
                </dd>

                <dt>
                    @Html.DisplayNameFor(model => model.TargetCountry.Name)
                </dt>

                <dd>
                    @Html.DisplayFor(model => model.TargetCountry.Name)
                </dd>
                <dt>
                    @Html.DisplayNameFor(model => model.Date)
                </dt>

                <dd>
                    @Html.DisplayFor(model => model.Date)
                </dd>

                <dt>
                    @Html.DisplayNameFor(model => model.Url)
                </dt>

                <dd>
                    @Html.DisplayFor(model => model.Url)
                </dd>

                <dt>
                    @Html.DisplayNameFor(model => model.IsPaid)
                </dt>

                <dd>
                    @Html.DisplayFor(model => model.IsPaid)
                </dd>

                <dt>
                    @Html.DisplayNameFor(model => model.Tags)
                </dt>

                <dd>
                    @foreach (var tag in Model.Tags)
                    {
                        @Html.ActionLink(tag.Name, "Index", new { tagsFilter = tag.TagID })@($"{", "}")
                    }

                </dd>
                @if (Model.Organizer != null)
                {
                    <dt>
                        @Html.DisplayNameFor(model => model.Organizer)
                    </dt>

                    <dd>
                        @Html.ActionLink(Model.Organizer.User.UserName, "Details", "Organizers", new { id = Model.Organizer.OrganizerID }, null)
                    </dd>
                }

                <dt>
                    @Html.DisplayNameFor(model => model.Speakers)
                </dt>

                <dd>
                    @Html.DisplayFor(model => model.Speakers)
                </dd>

            </dl>
        </div>

    </div>

    <div class="row buffer">
        <p class="pull-left">
            Evaluations:
        </p>
        <div class="col-md-4 col-xs-4 pull-right">
            <!-- Twitter -->
            <a href="http://twitter.com/home?status=" title="Share on Twitter" target="_blank" class="btn btn-twitter"><i class="fa fa-twitter"></i> Twitter</a>
            <!-- Facebook -->
            <a href="https://www.facebook.com/sharer/sharer.php?u=" title="Share on Facebook" target="_blank" class="btn btn-facebook"><i class="fa fa-facebook"></i> Facebook</a>
            <!-- Google+ -->
            <a href="https://plus.google.com/share?url=" title="Share on Google+" target="_blank" class="btn btn-googleplus"><i class="fa fa-google-plus"></i> Google+</a>
            <!-- LinkedIn -->
            <a href="http://www.linkedin.com/shareArticle?mini=true&url=&title=&summary=" title="Share on LinkedIn" target="_blank" class="btn btn-linkedin"><i class="fa fa-linkedin"></i> LinkedIn</a>
        </div>
    </div>


    <div class="row">

        <div class="well">

            <div class="thumbnail row" style="overflow: hidden;">

                <div class="col-md-7 col-xs-6">
                    <input type="text" id="full" />
                </div>
                <div class="col-md-4 col-xs-3">
                    <input id="input-id" type="number" class="rating pull-right" step="1" min=0 max=5 data-size="xs">
                </div>
                <div class="col-md-1 col-xs-1">
                    <button id="submitButton" type="submit" value="Submit" class="btn btn-success btn-lg pull-right"><span class="glyphicon glyphicon-ok"></span></button>
                </div>

            </div>


            @if (Model.Evaluation != null)
            {
                foreach (var eval in Model.Evaluation)
                {
                    <div class="thumbnail row" style="overflow: hidden;">
                        <div class="col-md-2 col-xs-3">
                            @if (Request.IsAuthenticated && eval.Owner.Image != null)
                            {
                                <label>@eval.Owner.UserName</label>
                                <img src="@Url.Action("GetImage","Conferences", new {imageId = eval.Owner.ImageId}, null)" class="img-responsive img-thumbnail" alt="Conference image" />
                            }
                            else
                            {
                                <img src="../../img/default.jpg" class="img-responsive img-thumbnail" alt="Conference image" />
                            }
                        </div>
                        <div class="col-md-6 col-xs-6">
                            @eval.Comment
                        </div>
                        <div class="col-md-4 col-xs-3">
                            <input id="input-id" disabled="true" showClear="true" type="number" class="rating pull-right" step="1" min=0 max=5 data-size="xs" value=@eval.CountOfStars>
                        </div>
                    </div>
                }
            }

        </div>
    </div>

</div>


<script type="text/javascript">

    //pass name filter to filter conferences
    var conference =
    {
        "conferenceId": @Model.ConferenceID,
    };

    var owner =
    {
        "ownerId": "@User.Identity.GetUserId()",
    };

    $("#submitButton").click(function () {

        $.ajax({
            url: '/Conferences/AddEvaluation/',
            type: "POST",
            dataType: "HTML",
            data: { conferenceId: conference.conferenceId, countOfStars:  $("#input-id").val(), comment: $("#full").val(), ownerId: owner.ownerId },
            success: function (data) {
                if (data != "") {
                    $("#details").html(data);
                }
            }
        });


    });
</script>

